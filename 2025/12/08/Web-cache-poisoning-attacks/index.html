<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>WEB缓存欺骗 | p0phday's Blog</title><meta name="author" content="@飞禽岛少年"><meta name="copyright" content="@飞禽岛少年"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Title: Cache Poisoning | OWASP Foundation URL Source: https:&#x2F;&#x2F;owasp.org&#x2F;www-community&#x2F;attacks&#x2F;Cache_Poisoning Markdown Content: Cache Poisoning | OWASP Foundation &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="WEB缓存欺骗">
<meta property="og:url" content="https://p0phday.github.io/2025/12/08/Web-cache-poisoning-attacks/index.html">
<meta property="og:site_name" content="p0phday&#39;s Blog">
<meta property="og:description" content="Title: Cache Poisoning | OWASP Foundation URL Source: https:&#x2F;&#x2F;owasp.org&#x2F;www-community&#x2F;attacks&#x2F;Cache_Poisoning Markdown Content: Cache Poisoning | OWASP Foundation &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&amp;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://p0phday.github.io/img/head.jpg">
<meta property="article:published_time" content="2025-12-08T14:47:12.000Z">
<meta property="article:modified_time" content="2025-12-08T15:15:21.973Z">
<meta property="article:author" content="@飞禽岛少年">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://p0phday.github.io/img/head.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "WEB缓存欺骗",
  "url": "https://p0phday.github.io/2025/12/08/Web-cache-poisoning-attacks/",
  "image": "https://p0phday.github.io/img/head.jpg",
  "datePublished": "2025-12-08T14:47:12.000Z",
  "dateModified": "2025-12-08T15:15:21.973Z",
  "author": [
    {
      "@type": "Person",
      "name": "@飞禽岛少年",
      "url": "https://p0phday.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/head.jpg"><link rel="canonical" href="https://p0phday.github.io/2025/12/08/Web-cache-poisoning-attacks/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'WEB缓存欺骗',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E9%98%85%E8%AF%BB/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page child" href="/categories/%E6%97%A5%E5%BF%97/"><i class="fa-fw fas fa-pen-nib"></i><span> 日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/2019/12/16/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">p0phday's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">WEB缓存欺骗</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E9%98%85%E8%AF%BB/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page child" href="/categories/%E6%97%A5%E5%BF%97/"><i class="fa-fw fas fa-pen-nib"></i><span> 日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/2019/12/16/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">WEB缓存欺骗</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-12-08T14:47:12.000Z" title="发表于 2025-12-08 22:47:12">2025-12-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-12-08T15:15:21.973Z" title="更新于 2025-12-08 23:15:21">2025-12-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>Title: Cache Poisoning | OWASP Foundation</p>
<p>URL Source: <a target="_blank" rel="noopener" href="https://owasp.org/www-community/attacks/Cache_Poisoning">https://owasp.org/www-community/attacks/Cache_Poisoning</a></p>
<p>Markdown Content: Cache Poisoning | OWASP Foundation</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>Please support the OWASP mission to improve software security through open source initiatives and community education. Donate Now!</p>
<p>Image 1: OWASP logo<br>Image 1: OWASP logo<br>•<br>•PROJECTS</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/projects/">Browse All Projects…</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://nest.owasp.org/contribute">Contribute to projects…</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-project-top-ten/">OWASP Top Ten</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-project-application-security-verification-standard/">OWASP Application Security Verification Standard</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://genai.owasp.org/">OWASP GenAI Security Project</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owaspai.org/">OWASP AI Exchange</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://cyclonedx.org/">OWASP CycloneDX Secure Bill of Materials</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-project-dependency-track/">OWASP Dependency Track</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-project-juice-shop/">OWASP Juice Shop</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/mas/">OWASP Mobile Application Security</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-project-modsecurity-core-rule-set/">OWASP ModSecurity Core Rule Set</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-project-samm/">OWASP Software Assurance Maturity Model (SAMM)</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-project-web-security-testing-guide/">OWASP Web Security Testing Guide</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasporg.atlassian.net/servicedesk/customer/portal/7/create/70?src=-1419759666">Start a New Project…</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-community/">Community Contributions</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/gsoc">Google Summer of Code</a><br>CHAPTERS</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/">Find a Local Chapter…</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/#Africa">Africa</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/#Asia">Asia</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/#TheCarribean">Caribbean</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/#CentralAmerica">Central America</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/#Europe">Europe</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/#NorthAmerica">North America</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/#Oceania">Oceania</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/#SouthAmerica">South America</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasporg.atlassian.net/servicedesk/customer/portal/8/group/20/create/90?src=-1419759666">Start a Local Chapter…</a><br>EVENTS</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.glueup.com/event/owasp-global-appsec-eu-2026-vienna-austria-162243/">OWASP Global AppSec EU 2026</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.glueup.com/event/so-you-want-to-be-an-owasp-speaker-virtual-event-163522/">So You Want to be an OWASP Speaker</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.glueup.com/event/london-owasp-training-days-2026-162538/">OWASP London Training Days 2026</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://basconf.org/">OWASP BASC 2026</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://appsecil.org/">OWASP AppSec Israel 2026</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-chapter-italy/events/OWASPItalyDay2026-06-18">OWASP Italy Day 2026</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://lascon.org/">OWASP LASCON 2026</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/chapters/events/">Upcoming Chapter Events</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/events/">Browse All Events…</a><br>ABOUT</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/about/">About OWASP</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/awards/">Awards</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/careers/">Careers</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/committees/">Committees</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/contact/">Contact Us</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/supporters/">Corporate Supporters</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/donate/">Donate</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/finance/">Finance</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-board/">Global Board</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-board-eu/">Global Board EU</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/governance/">Governance</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.glueup.com/">Membership Portal</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/news/">Opinions &amp; News</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/www-policy/">Policies</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://owasp.org/corporate/">Staff</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.youtube.com/user/OWASPGLOBAL/videos">Video</a><br>•MAKE A DONATION<br>•BECOME A MEMBER<br>•SITEMAP</p>
</li>
</ul>
<p>Image 2<br>Image 2<br>•PROJECTS<br>•Browse All Projects…<br>•Contribute to projects…<br>•OWASP Top Ten<br>•OWASP Application Security Verification Standard<br>•OWASP GenAI Security Project<br>•OWASP AI Exchange<br>•OWASP CycloneDX Secure Bill of Materials<br>•OWASP Dependency Track<br>•OWASP Juice Shop<br>•OWASP Mobile Application Security<br>•OWASP ModSecurity Core Rule Set<br>•OWASP Software Assurance Maturity Model (SAMM)<br>•OWASP Web Security Testing Guide<br>•Start a New Project…<br>•Community Contributions<br>•Google Summer of Code<br>•CHAPTERS<br>•Find a Local Chapter…<br>•Africa<br>•Asia<br>•Caribbean<br>•Central America<br>•Europe<br>•North America<br>•Oceania<br>•South America<br>•Start a Local Chapter…<br>•EVENTS<br>•OWASP Global AppSec EU 2026<br>•So You Want to be an OWASP Speaker<br>•OWASP London Training Days 2026<br>•OWASP BASC 2026<br>•OWASP AppSec Israel 2026<br>•OWASP Italy Day 2026<br>•OWASP LASCON 2026<br>•Upcoming Chapter Events<br>•Browse All Events…<br>•ABOUT<br>•About OWASP<br>•Awards<br>•Careers<br>•Committees<br>•Contact Us<br>•Corporate Supporters<br>•Donate<br>•Finance<br>•Global Board<br>•Global Board EU<br>•Governance<br>•Membership Portal<br>•Opinions &amp; News<br>•Policies<br>•Staff<br>•Video<br>•<br>•</p>
<p>StoreDonateJoin</p>
<p>This website uses cookies to analyze our traffic and only share that information with our analytics partners.</p>
<p>Accept</p>
<p>x</p>
<p>Store</p>
<p>Donate</p>
<p>Join</p>
<p>Cache Poisoning<br>Author: Weilin Zhong, Rezos</p>
<p>Contributor(s): Pshanks, KristenS, Ingo86, Achim, kingthorin</p>
<p>Description<br>The impact of a maliciously constructed response can be magnified if it is cached either by a web cache used by multiple users or even the browser cache of a single user. If a response is cached in a shared web cache, such as those commonly found in proxy servers, then all users of that cache will continue to receive the malicious content until the cache entry is purged. Similarly, if the response is cached in the browser of an individual user, then that user will continue to receive the malicious content until the cache entry is purged, although only the user of the local browser instance will be affected.</p>
<p>To successfully carry out such an attack, an attacker:</p>
<p>•Finds the vulnerable service code, which allows them to fill the HTTP header field with many headers.<br>•Forces the cache server to flush its actual cache content, which we want to be cached by the servers.<br>•Sends a specially crafted request, which will be stored in cache.<br>•Sends the next request. The previously injected content stored in cache will be the response to this request.</p>
<p>This attack is rather difficult to carry out in a real environment. The list of conditions is long and hard to accomplish by the attacker. However it’s easier to use this technique than Cross-User Defacement.</p>
<p>A Cache Poisoning attack is possible because of HTTP Response Splitting and flaws in the web application. It is crucial from the attacker’s point of view that the application allows for filling the header field with more than one header using CR (Carriage Return) and LF (Line Feed) characters.</p>
<p>Examples<br>We have found a web page, which gets its service name from the “page” argument and then redirects (302) to this service.</p>
<p>e.g.</p>
<p><a target="_blank" rel="noopener" href="http://testsite.com/redir.php?page=http://other.testsite.com/">http://testsite.com/redir.php?page=http://other.testsite.com/</a><br>And exemplary code of the redir.php:</p>
<p>rezos@dojo ~&#x2F;public_html $ cat redir.php<br><?php
header ("Location: " . $_GET['page']);
?><br>Crafting appropriate request:</p>
<p>1.Remove page from the cache</p>
<p>GET <a target="_blank" rel="noopener" href="http://testsite.com/index.html">http://testsite.com/index.html</a> HTTP&#x2F;1.1<br>Pragma: no-cache<br>Host: testsite.com<br>User-Agent: Mozilla&#x2F;4.7 [en] (WinNT; I)<br>Accept: image&#x2F;gif, image&#x2F;x-xbitmap, image&#x2F;jpeg, image&#x2F;pjpeg,<br>image&#x2F;png, <em>&#x2F;</em><br>Accept-Encoding: gzip<br>Accept-Language: en<br>Accept-Charset: iso-8859-1,*,utf-8<br>HTTP header fields</p>
<p>Pragma: no-cache<br>and ‘Cache-Control: no-cache’ should remove the page from cache (if the page is stored in cache, obviously).</p>
<p>1.Using HTTP Response Splitting we force cache server to generate two responses to one request</p>
<p>GET <a target="_blank" rel="noopener" href="http://testsite.com/redir.php?site=%0D%0AContent-">http://testsite.com/redir.php?site=%0d%0aContent-</a><br>Length:%200%0d%0a%0d%0aHTTP&#x2F;1.1%20200%20OK%0d%0aLast-<br>Modified:%20Mon,%2027%20Oct%202009%2014:50:18%20GMT%0d%0aConte<br>nt-Length:%2020%0d%0aContent-<br>Type:%20text&#x2F;html%0d%0a%0d%0a<html>deface!</html> HTTP&#x2F;1.1<br>Host: testsite.com<br>User-Agent: Mozilla&#x2F;4.7 [en] (WinNT; I)<br>Accept: image&#x2F;gif, image&#x2F;x-xbitmap, image&#x2F;jpeg, image&#x2F;pjpeg,<br>image&#x2F;png, <em>&#x2F;</em><br>Accept-Encoding: gzip<br>Accept-Language: en<br>Accept-Charset: iso-8859-1,*,utf-8<br>We are intentionally setting the future time (in the header it’s set to 27 October 2009) in the second response HTTP header “Last-Modified” to store the response in the cache.</p>
<p>We may get this effect by setting the following headers:</p>
<p>•Last-Modified (checked by the If-Modified-Since header)<br>•ETag (checked by the If-None-Match header)</p>
<p>1.Sending request for the page, which we want to replace in the cache of the server</p>
<p>GET <a target="_blank" rel="noopener" href="http://testsite.com/index.html">http://testsite.com/index.html</a> HTTP&#x2F;1.1<br>Host: testsite.com<br>User-Agent: Mozilla&#x2F;4.7 [en] (WinNT; I)<br>Accept: image&#x2F;gif, image&#x2F;x-xbitmap, image&#x2F;jpeg, image&#x2F;pjpeg,<br>image&#x2F;png, <em>&#x2F;</em><br>Accept-Encoding: gzip<br>Accept-Language: en<br>Accept-Charset: iso-8859-1,*,utf-8<br>In theory, the cache server should match the second answer from the request #2 to the request #3. In this way we’ve replaced the cache content.</p>
<p>The rest of the requests should be executed during one connection (if the cache server doesn’t require a more sophisticated method to be used), possibly immediately one after another.</p>
<p>It may appear problematic to use this attack as a universal technique for cache poisoning. It’s due to cache server’s different connection model and request processing implementations. What does it mean? That for example effective method to poison Apache 2.x cache with mod_proxy and mod_cache modules won’t work with Squid.</p>
<p>A different problem is the length of the URI, which sometime makes it impossible to put the necessary response header, which would next be matched to the request for the poisoned page.</p>
<p>The request examples used are from the Amit Klein paper referenced below, which were modified on the needs of the article.</p>
<p>More information can be found in this document, which focuses on these kinds of attacks by Amit Klein, Director of Security and Research</p>
<p>Edit on GitHub</p>
<p>WatchStar</p>
<p>The OWASP® Foundation works to improve the security of software through its community-led open source software projects, hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.</p>
<p>Important Community Links<br>•Community<br>•Attacks (You are here)<br>•Vulnerabilities<br>•Controls</p>
<p>Upcoming OWASP Global Events<br>•OWASP Global AppSec EU 2026 - Vienna, Austria<br>•June 22-26, 2026<br>•OWASP Global AppSec USA 2026 - San Francisco, CA<br>•November 2-6, 2026<br>•OWASP Global AppSec EU 2027 - Vienna, Austria<br>•June 21-25, 2027<br>•OWASP Global AppSec USA 2027 - Atlanta, GA<br>•September 20-24, 2027<br>•OWASP Global AppSec EU 2028 - Vienna, Austria<br>•June 19-23, 2028</p>
<p>Spotlight: 7ASecurity<br>Image 3: image<br>Image 3: image<br>7ASecurity is an ISO27001 and SOC2 certified cybersecurity consultancy and OWASP Platinum Supporter specializing in manual, high-quality penetration tests and secure code audits. Trusted since 2011 by the Linux Foundation, Mozilla Foundation, Tor Project, The Guardian, and many others (7asecurity.com&#x2F;publications). Every engagement is tailored to the client priorities and threat model, and guided through a dedicated channel from scoping to free fix verification. With researcher-led testing that outperforms automation, 7ASecurity consistently uncovers vulnerabilities others miss — delivering real results with proof and replication steps, clear guidance, and measurable security improvements that stand up to real-world threats.<br>Corporate Supporters<br>Image 4: image<br>Image 4: image<br>Image 5: image<br>Image 5: image<br>Image 6: image<br>Image 6: image<br>Image 7: image<br>Image 7: image<br>Image 8: image<br>Image 8: image<br>Image 9: image<br>Image 9: image<br>Image 10: image<br>Image 10: image<br>Image 11: image<br>Image 11: image<br>Image 12: image<br>Image 12: image<br>Become a corporate supporter</p>
<p>•HOME<br>•PROJECTS<br>•CHAPTERS<br>•EVENTS<br>•ABOUT<br>•PRIVACY<br>•SITEMAP<br>•CONTACT</p>
<p>OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, OWASP Boston Application Security Conference, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our General Disclaimer. OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://p0phday.github.io">@飞禽岛少年</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://p0phday.github.io/2025/12/08/Web-cache-poisoning-attacks/">https://p0phday.github.io/2025/12/08/Web-cache-poisoning-attacks/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://p0phday.github.io" target="_blank">p0phday's Blog</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/head.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/12/07/Auto_copy_Cources/" title="Python 自动拷贝课件源代码，适合“偷”课件源代码"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Python 自动拷贝课件源代码，适合“偷”课件源代码</div></div><div class="info-2"><div class="info-item-1">Python 自动拷贝课件源代码，适合“偷”课件源代码一、编写python源代码1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">@飞禽岛少年</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/p0phday"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">天涯远不远？人就在天涯，天涯怎么会远？</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/08/Web-cache-poisoning-attacks/" title="WEB缓存欺骗">WEB缓存欺骗</a><time datetime="2025-12-08T14:47:12.000Z" title="发表于 2025-12-08 22:47:12">2025-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/07/Auto_copy_Cources/" title="Python 自动拷贝课件源代码，适合“偷”课件源代码">Python 自动拷贝课件源代码，适合“偷”课件源代码</a><time datetime="2025-12-07T04:55:39.000Z" title="发表于 2025-12-07 12:55:39">2025-12-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/15/e-book-traditional-vertical-conversion-simplified-horizontal/" title="电子书繁体竖排转换简体横排">电子书繁体竖排转换简体横排</a><time datetime="2025-11-15T04:55:39.000Z" title="发表于 2025-11-15 12:55:39">2025-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/10/2025-Data-1/" title="通用AIGC检测与降重">通用AIGC检测与降重</a><time datetime="2025-11-10T01:49:57.000Z" title="发表于 2025-11-10 09:49:57">2025-11-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/01/5ire/" title="5ire介绍与部署以及其能带给普通人什么">5ire介绍与部署以及其能带给普通人什么</a><time datetime="2025-11-01T00:48:26.000Z" title="发表于 2025-11-01 08:48:26">2025-11-01</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2020 - 2025 By @飞禽岛少年</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>